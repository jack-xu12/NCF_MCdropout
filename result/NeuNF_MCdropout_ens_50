Namespace(batch_size=256, dataset='ml-1m', dropout_rate=256, epochs=30, item_rate=1, layers='[64,32,16,8]', learner='adam', lr=0.001, mf_pretrain='', mlp_pretrain='', num_ens=50, num_factors=64, num_neg=4, out=1, path='Data/', user_rate=1, verbose=1)
NeuMF arguments: Namespace(batch_size=256, dataset='ml-1m', dropout_rate=256, epochs=30, item_rate=1, layers='[64,32,16,8]', learner='adam', lr=0.001, mf_pretrain='', mlp_pretrain='', num_ens=50, num_factors=64, num_neg=4, out=1, path='Data/', user_rate=1, verbose=1) 
num_users:6040, num_items:3706
user_sample_num:6040, item_sample_num:3706
Load data done [62.7 s]. #user=6040, #item=3706, #train=994169, #test=6040
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
user_input (InputLayer)         [(None, 1)]          0                                            
__________________________________________________________________________________________________
item_input (InputLayer)         [(None, 1)]          0                                            
__________________________________________________________________________________________________
mlp_embedding_user (Embedding)  (None, 1, 32)        193280      user_input[0][0]                 
__________________________________________________________________________________________________
mlp_embedding_item (Embedding)  (None, 1, 32)        118592      item_input[0][0]                 
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 32)           0           mlp_embedding_user[0][0]         
__________________________________________________________________________________________________
flatten_3 (Flatten)             (None, 32)           0           mlp_embedding_item[0][0]         
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 64)           0           flatten_2[0][0]                  
                                                                 flatten_3[0][0]                  
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64)           0           concatenate[0][0]                
__________________________________________________________________________________________________
layer1 (Dense)                  (None, 32)           2080        dropout[0][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 32)           0           layer1[0][0]                     
__________________________________________________________________________________________________
mf_embedding_user (Embedding)   (None, 1, 64)        386560      user_input[0][0]                 
__________________________________________________________________________________________________
mf_embedding_item (Embedding)   (None, 1, 64)        237184      item_input[0][0]                 
__________________________________________________________________________________________________
layer2 (Dense)                  (None, 16)           528         dropout_1[0][0]                  
__________________________________________________________________________________________________
flatten (Flatten)               (None, 64)           0           mf_embedding_user[0][0]          
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64)           0           mf_embedding_item[0][0]          
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 16)           0           layer2[0][0]                     
__________________________________________________________________________________________________
multiply (Multiply)             (None, 64)           0           flatten[0][0]                    
                                                                 flatten_1[0][0]                  
__________________________________________________________________________________________________
layer3 (Dense)                  (None, 8)            136         dropout_2[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 72)           0           multiply[0][0]                   
                                                                 layer3[0][0]                     
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 72)           0           concatenate_1[0][0]              
__________________________________________________________________________________________________
prediction (Dense)              (None, 1)            73          dropout_3[0][0]                  
==================================================================================================
Total params: 938,433
Trainable params: 938,433
Non-trainable params: 0
__________________________________________________________________________________________________
Init: HR = 0.1035, NDCG = 0.0468	 [130.4 s]
